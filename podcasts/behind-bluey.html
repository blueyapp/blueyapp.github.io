<!DOCTYPE html>
<html lang="en">
   <head>
      <meta charset="UTF-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>Behind Bluey</title>
      <meta name="title" content="Behind Bluey">
      <meta name="description" content="Ever wondered how an episode of Bluey, the #1 Australian children's TV show, is made? Join Bluey creator and showrunner Joe Brumm and members of the design, animation and production team as they talk shop about what goes into making the global phenomena.&#10;&#10;Behind Bluey is a rare opportunity for super fans, parents / carers and screen professionals to hear directly from some of the key Bluey creatives. They share warts-and-all stories of the screen craft and how they make each episode super special.&#10;&#10;Each podcast episode is full of spoilers, so make sure to check the TV episode on ABC iview before pressing play, exclusively on ABC listen.">
      <meta name="keywords" content="bluey, bluey, bluey">
      <meta name="robots" content="index, follow">
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="language" content="English">
      <meta name="author" content="Bluey Heeler">
      <!-- Meta tags for social share preview -->
      <meta property="og:title" content="Behind Bluey">
      <meta property="og:description" content="Ever wondered how an episode of Bluey, the #1 Australian children's TV show, is made? Join Bluey creator and showrunner Joe Brumm and members of the design, animation and production team as they talk shop about what goes into making the global phenomena.&#10;&#10;Behind Bluey is a rare opportunity for super fans, parents / carers and screen professionals to hear directly from some of the key Bluey creatives. They share warts-and-all stories of the screen craft and how they make each episode super special.&#10;&#10;Each podcast episode is full of spoilers, so make sure to check the TV episode on ABC iview before pressing play, exclusively on ABC listen.">
      <meta property="og:image" content="https://live-production.wcms.abc-cdn.net.au/452754d26cd6da42b18081d5dcf3236f">
      <!-- URL to your image -->
      <meta property="og:url" content="https://pages.blueynet.org/podcasts/behind-bluey">
      <!-- URL of your page -->
      <meta name="twitter:card" content="summary_large_image">
      <meta name="twitter:title" content="Behind Bluey">
      <meta name="twitter:description" content="Ever wondered how an episode of Bluey, the #1 Australian children's TV show, is made? Join Bluey creator and showrunner Joe Brumm and members of the design, animation and production team as they talk shop about what goes into making the global phenomena.&#10;&#10;Behind Bluey is a rare opportunity for super fans, parents / carers and screen professionals to hear directly from some of the key Bluey creatives. They share warts-and-all stories of the screen craft and how they make each episode super special.&#10;&#10;Each podcast episode is full of spoilers, so make sure to check the TV episode on ABC iview before pressing play, exclusively on ABC listen.">
      <meta name="twitter:image" content="https://live-production.wcms.abc-cdn.net.au/452754d26cd6da42b18081d5dcf3236f">
      <!-- URL to your image -->
      <link rel="icon" href="/bluey-star.ico" type="image/x-icon">
      <link href="/fonts/HelloHeadline.css" rel="stylesheet" type="text/css">
      <style>
         * {
         box-sizing: border-box;
         margin: 0;
         padding: 0;
         }
         body {
         font-family: "Hello Headline", Arial, sans-serif !important;
         background-color: #87c0e8 !important;
         transition: background-color 0.3s, color 0.3s;
         }
         .album {
         font-family: "Hello Headline", Arial, sans-serif;
         background-color: #87c0e8;
         color: white;
         text-align: center;
         margin: 0;
         padding: 0;
         display: flex;
         flex-direction: column;
         justify-content: center;
         align-items: center;
         transition: background-color 0.3s, color 0.3s;
         }
         .album .img-container {
         width: 200px;
         border-radius: 10px;
         overflow: hidden;
         margin-top: 20px;
         }
         .album img {
         width: 100%;
         border-radius: 10px;
         }
         .container {
         max-width: 1200px;
         margin: 0 auto;
         padding: 20px;
         }
         .header {
         display: flex;
         align-items: center;
         justify-content: space-between;
         }
         .logo {
         width: 150px;
         border-radius: 0px;
         }
         .nav {
         display: flex;
         list-style: none;
         align-items: center;
         }
         .nav li {
         margin-left: 20px;
         display: flex;
         align-items: center;
         }
         .nav a {
         text-decoration: none;
         color: #ffffff;
         font-weight: bold;
         transition: color 0.3s;
         }
         .music-player {
         background-color: #fff;
         padding: 20px;
         box-shadow: 0 2px 4px rgba(0,0,0,0.1);
         border-radius: 10px;
         margin-top: 20px;
         transition: background-color 0.3s, color 0.3s;
         }
         .music-player h1 {
         transition: color 0.3s;
         margin-bottom: 15px;
         }
         .music-list {
         list-style-type: none;
         padding: 0;
         margin: 0;
         max-height: 400px;
         overflow-y: auto;
         transition: background-color 0.3s;
         }
         .music-item {
         display: flex;
         align-items: center;
         padding: 10px;
         border-bottom: 1px solid #ddd;
         cursor: pointer;
         transition: background-color 0.3s, color 0.3s, border-color 0.3s;
         }
         .music-item:hover {
         background-color: #f0f0f0;
         }
         .highlight {
         background-color: #d0e0ff; /* Light mode highlight */
         font-weight: bold;
         }
         .audio-player-container {
         background-color: #fff;
         padding: 10px;
         box-shadow: 0 2px 4px rgba(0,0,0,0.1);
         margin-top: 15px;
         transition: background-color 0.3s;
         }
         audio {
         width: 100%;
         }
         .controls {
         display: flex;
         gap: 10px;
         align-items: center;
         margin-bottom: 10px;
         }

         /* SVG Icon & Control Button Styling */
         .control-button {
            background: none;
            border: none;
            margin: 8px;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            color: #555; /* Default icon stroke color for light mode */
            transition: color 0.2s, background-color 0.2s, box-shadow 0.2s;
            border-radius: 6px;
         }
         .control-button svg {
            width: 24px;
            height: 24px;
            vertical-align: middle;
            stroke: currentColor; /* SVG lines take color from parent button */
            fill: none; /* Ensure icons are line art */
            stroke-width: 2;
            stroke-linecap: round;
            stroke-linejoin: round;
            transition: background-color 0.2s, stroke 0.2s;
         }
         .control-button:hover {
            color: #007bff; /* Icon stroke color on hover */
         }

         .music-item .control-button { /* Download button in list */
            margin-left: auto;
            padding: 5px;
         }
         .music-item .control-button svg {
            width: 20px;
            height: 20px;
         }

         #loadingContainer {
            display: none;
            align-items: center;
            justify-content: center;
            padding: 8px; /* Consistent with other control buttons */
         }
         #loadingContainer svg.icon-loader {
            width: 24px; /* Consistent with other control buttons */
            height: 24px;
            stroke: #555; /* Default stroke for light mode */
            fill: none;
            stroke-width: 2;
            stroke-linecap: round;
            stroke-linejoin: round;
            animation: icon-loading-spin 0.8s linear infinite;
            transform-origin: center;
         }
         @keyframes icon-loading-spin {
            to { transform: rotate(360deg); }
         }

         /* Light mode active state for repeat buttons */
         .controls button.control-button.active-control {
            box-shadow: 0 0 8px 2px #cce7ff;
            /* Button itself doesn't need a background if SVG gets it */
         }
         .controls button.control-button.active-control svg {
            background-color: #cce7ff;
            stroke: #0056b3; /* Icon stroke color for contrast */
            /* fill: #0056b3; /* Only if there are filled parts like the '1' */
            border-radius: 4px;
         }
         /* Special handling for the '1' in repeat-once if it were a fill */
         .controls button.control-button.active-control svg.icon-repeat-once .icon-text-numeral {
             stroke: #0056b3; /* Ensure '1' path color matches */
         }


         p {
         margin-bottom: 30px;
         margin-top: 30px;
         font-family: "Hello Headline", sans-serif;
         color: white;
         text-align: center;
         transition: color 0.3s;
         }
         @media (max-width: 768px) {
         .header { flex-direction: column; }
         .nav { margin-top: 20px; }
         }
         .popup {
         position: fixed; top: 0; left: 0; width: 100%; height: 100%;
         background: rgba(0, 0, 0, 0.7); color: white; display: none;
         justify-content: center; align-items: center; z-index: 1000;
         transition: background-color 0.3s;
         }
         .popup-content {
         background: #333; padding: 20px; border-radius: 10px;
         text-align: center; position: relative;
         transition: background-color 0.3s, color 0.3s;
         }
         .popup-close {
         position: absolute; top: 10px; right: 10px;
         cursor: pointer; font-size: 20px; color: white;
         transition: color 0.3s;
         }

         /* --- Dark mode styles --- */
         body.dark {
         background: #191d25 !important;
         color: #dbeafe !important;
         }
         body.dark .nav a { color: #fbbf24 !important; }
         body.dark .album {
            background-color: #191d25 !important;
            color: #dbeafe !important;
         }
         body.dark p { color: #dbeafe !important; }
         body.dark .music-player {
            background-color: #23293a !important;
            color: #dbeafe !important;
         }
         body.dark .music-player h1 { color: #fbbf24 !important; }
         body.dark .audio-player-container { background-color: #23293a !important; }

         body.dark .control-button {
            color: #fbbf24; /* Default icon stroke color for dark mode */
         }
         body.dark .control-button:hover {
            color: #fff; /* Brighter icon stroke on hover */
         }
         body.dark #loadingContainer svg.icon-loader {
            stroke: #fbbf24;
         }

         /* Dark mode active state for repeat buttons */
         body.dark .controls button.control-button.active-control {
            box-shadow: 0 0 8px 2px #ffe066 !important;
         }
         body.dark .controls button.control-button.active-control svg {
            background: #fbbf24 !important;
            stroke: #23293a !important; /* Icon stroke color for contrast */
            /* fill: #23293a !important; /* Only if '1' is filled */
            border-radius: 4px;
         }
          body.dark .controls button.control-button.active-control svg.icon-repeat-once .icon-text-numeral {
             stroke: #23293a !important; /* Ensure '1' path color matches */
         }

         body.dark .music-list { background: #23293a !important; }
         body.dark .music-item {
            background: #23293a !important;
            color: #fbbf24 !important;
            border-bottom-color: #394867 !important;
         }
         body.dark .music-item:hover { background: #394867 !important; }
         body.dark .music-item.highlight {
            background: #fbbf24 !important;
            color: #23293a !important;
         }
         /* Download icon color on highlight in dark mode */
         body.dark .music-item.highlight .control-button.download-button {
            color: #23293a !important; /* Sets stroke for SVG via currentColor */
         }

         /* Download icon color on highlight in light mode */
         body:not(.dark) .music-item.highlight .control-button.download-button {
            color: #000000 !important; /* Sets stroke for SVG via currentColor */
         }

         body.dark .popup { background: rgba(0, 0, 0, 0.92) !important; }
         body.dark .popup-content {
            background: #23293a !important;
            color: #fbbf24 !important;
         }
         body.dark .popup-close { color: #fbbf24 !important; }

         /* --- Dark mode toggle button --- */
         .darkmode-toggle {
         background: none; border: none; cursor: pointer; border-radius: 50%;
         width: 36px; height: 36px; display: flex; align-items: center;
         justify-content: center; outline: none; padding: 2px; transition: background 0.2s;
         }
         .darkmode-toggle:focus,
         .darkmode-toggle:hover { background: rgba(128, 128, 128, 0.12); }
         body.dark .darkmode-toggle:focus,
         body.dark .darkmode-toggle:hover { background: rgba(251, 191, 36, 0.2); }
         .darkmode-toggle svg {
         width: 24px; height: 24px; display: block; pointer-events: none;
         stroke: currentColor; /* Make toggle SVGs also use currentColor from button */
         }
         /* Ensure specific stroke colors for sun/moon in toggle if currentColor isn't desired for them */
         .darkmode-toggle svg.sun { stroke: #fff; }
         body.dark .darkmode-toggle svg.moon { stroke: #fbbf24; }


         .dark .darkmode-toggle .sun { display: none; }
         .dark .darkmode-toggle .moon { display: block; }
         .darkmode-toggle .moon { display: none; }
         .darkmode-toggle .sun { display: block; }
      </style>
   </head>
   <body>
      <div class="container">
         <div class="header">
            <img src="/images/uFYNVaPt6dz1PH6tZ4vfdyOnKS.png" alt="Bluey" class="logo">
            <ul class="nav">
               <li><a href="/">Home</a></li>
               <li><a href="/watch">Watch</a></li>
               <li><a href="/music">Music</a></li>
               <li><a href="/audiobooks">Audio Books</a></li>
               <li><a href="/download">App</a></li>
               <li>
                  <button class="darkmode-toggle" id="darkToggle" title="Toggle dark mode" aria-label="Toggle dark mode">
                     <svg class="sun" viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"/><g><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></g>
                     </svg>
                     <svg class="moon" viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
                     </svg>
                  </button>
               </li>
            </ul>
         </div>
         <div class="album">
            <div class="img-container">
               <img src="https://live-production.wcms.abc-cdn.net.au/93486be7593cf1dd60324dc4fae6dfe5" alt="Logo">
            </div>
         </div>
         <div class="music-player">
            <h1>Behind Bluey</h1>
            <div class="controls">
               <button id="repeatOnceButton" class="control-button" title="Repeat Once">
                  <svg viewBox="0 0 24 24" class="icon-repeat-once">
                    <polyline points="17 1 21 1 21 5"></polyline>
                    <path d="M3 11V9a4 4 0 0 1 4-4h14"></path>
                    <polyline points="7 23 3 23 3 19"></polyline>
                    <path d="M21 13v2a4 4 0 0 1-4 4H3"></path>
                    <path d="M12 14.5 V9.5 M10.5 11 L12 9.5" class="icon-text-numeral"></path> </svg>
               </button>
               <button id="repeatAllButton" class="control-button" title="Repeat All">
                  <svg viewBox="0 0 24 24" class="icon-repeat-all">
                    <polyline points="17 1 21 1 21 5"></polyline>
                    <path d="M3 11V9a4 4 0 0 1 4-4h14"></path>
                    <polyline points="7 23 3 23 3 19"></polyline>
                    <path d="M21 13v2a4 4 0 0 1-4 4H3"></path>
                  </svg>
               </button>
               <div id="loadingContainer">
                  <svg viewBox="0 0 24 24" class="icon-loader">
                    <line x1="12" y1="2" x2="12" y2="6"></line>
                    <line x1="12" y1="18" x2="12" y2="22"></line>
                    <line x1="4.93" y1="4.93" x2="7.76" y2="7.76"></line>
                    <line x1="16.24" y1="16.24" x2="19.07" y2="19.07"></line>
                    <line x1="2" y1="12" x2="6" y2="12"></line>
                    <line x1="18" y1="12" x2="22" y2="12"></line>
                    <line x1="4.93" y1="19.07" x2="7.76" y2="16.24"></line>
                    <line x1="16.24" y1="7.76" x2="19.07" y2="4.93"></line>
                  </svg>
               </div>
            </div>
            <div class="audio-player-container">
               <audio id="audioPlayer" controls></audio>
            </div>
            <ul id="musicList" class="music-list"></ul>
         </div>
      </div>
      <div id="safariPopup" class="popup">
         <div class="popup-content">
            <span class="popup-close" onclick="closePopup()">&times;</span>
            <h2>Autoplay Blocked</h2>
            <p>Due to autoplay restrictions on Safari, please click the play button to start the music.</p>
         </div>
      </div>

      <script>
         const themeKey = "bluey-listen-along-theme";
         const root = document.body;
         const darkToggle = document.getElementById("darkToggle");

         function setTheme(dark) {
           if (dark) {
             root.classList.add('dark');
             localStorage.setItem(themeKey, "dark");
           } else {
             root.classList.remove('dark');
             localStorage.setItem(themeKey, "light");
           }
         }
         (() => {
           const saved = localStorage.getItem(themeKey);
           if (saved === "dark" || (!saved && window.matchMedia("(prefers-color-scheme: dark)").matches)) {
             setTheme(true);
           } else {
             setTheme(false);
           }
         })();
         if (darkToggle) {
            darkToggle.onclick = () => setTheme(!root.classList.contains('dark'));
         }
      </script>

      <script>
         const EMBY_URL = 'https://blueynet.org';
         const EMBY_USER_ID = 'ba603d94a7c24b3b8c7e7ea2fedc9162';
         const EMBY_API_TOKEN = '6b2548952ea2439ea800b8cd3f1072d1';
         const parentID = '185625';

          const musicListElement = document.getElementById('musicList');
          const audioPlayer = document.getElementById('audioPlayer');
          const repeatOnceButton = document.getElementById('repeatOnceButton');
          const repeatAllButton = document.getElementById('repeatAllButton');
          const loadingContainer = document.getElementById('loadingContainer');
          const safariPopup = document.getElementById('safariPopup');

          const downloadIconSVG = `
            <svg viewBox="0 0 24 24" class="icon-download">
              <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
              <polyline points="7 10 12 15 17 10"></polyline>
              <line x1="12" y1="15" x2="12" y2="3"></line>
            </svg>`;

          let musicItems = [];
          let currentIndex = 0;
          let repeatOnce = false;
          let repeatAll = false;

          async function fetchMusicData() {
              loadingContainer.style.display = 'inline-flex';
              try {
                  const response = await fetch(`${EMBY_URL}/emby/Users/${EMBY_USER_ID}/Items?ParentId=${parentID}&Fields=BasicSyncInfo,CanDelete,PrimaryImageAspectRatio,SyncStatus&ImageTypeLimit=1&EnableTotalRecordCount=false&SortBy=ProductionYear%2CPremiereDate%2CSortName&SortOrder=Ascending&X-Emby-Token=${EMBY_API_TOKEN}`);
                  const data = await response.json();
                  return data.Items;
              } catch (error) {
                  console.error("Failed to fetch music data:", error);
                  return [];
              } finally {
                  loadingContainer.style.display = 'none';
              }
          }

          function createMusicItemElement(musicItem, index) {
              const li = document.createElement('li');
              li.className = 'music-item';

              const title = document.createElement('span');
              title.textContent = `${musicItem.Name}`;

              const downloadButton = document.createElement('button');
              downloadButton.className = 'control-button download-button';
              downloadButton.title = 'Download';
              downloadButton.innerHTML = downloadIconSVG; // SVG attributes are set in CSS or within the SVG string
              downloadButton.onclick = (event) => {
                  event.stopPropagation();
                  const musicId = musicItem.Id;
                  const downloadUrl = `${EMBY_URL}/emby/Items/${musicId}/Download?api_key=${EMBY_API_TOKEN}`;
                  window.open(downloadUrl, '_blank');
              };

              li.appendChild(title);
              li.appendChild(downloadButton);
              li.onclick = () => playMusic(index);
              return li;
          }

          function displayMusicList(musicItems) {
              musicListElement.innerHTML = '';
              musicItems.forEach((musicItem, index) => {
                  const musicItemElement = createMusicItemElement(musicItem, index);
                  musicListElement.appendChild(musicItemElement);
              });
          }

          function updateHighlight() {
              const items = musicListElement.querySelectorAll('.music-item');
              items.forEach((item, index) => {
                  item.classList.toggle('highlight', index === currentIndex);
              });
          }

          function playMusic(index) {
              currentIndex = index;
              updateHighlight();
              const musicId = musicItems[index].Id;
              const musicUrl = `${EMBY_URL}/emby/Audio/${musicId}/universal?UserId=${EMBY_USER_ID}&MaxStreamingBitrate=4000000&Container=opus,mp3|mp3,mp2,mp3|mp2,m4a|aac,mp4|aac,flac,webma,webm,wav|PCM_S16LE,wav|PCM_S24LE,ogg&TranscodingContainer=aac&TranscodingProtocol=hls&AudioCodec=aac&api_key=${EMBY_API_TOKEN}`;
              const musicItem = musicItems[index];

              if ('mediaSession' in navigator) {
                  navigator.mediaSession.metadata = new MediaMetadata({
                      title: musicItem.Name || 'Unknown Title',
                      artist: musicItem.Album || 'Behind Bluey',
                      album: musicItem.Album || 'Behind Bluey',
                      artwork: [
                          {
                              src: `${EMBY_URL}/emby/Items/${musicId}/Images/Primary?tag=${musicTag}&api_key=${EMBY_API_TOKEN}`,
                              sizes: '512x512',
                              type: 'image/png',
                          },
                      ],
                  });
                  navigator.mediaSession.setActionHandler('play', () => audioPlayer.play());
                  navigator.mediaSession.setActionHandler('pause', () => audioPlayer.pause());
                  navigator.mediaSession.setActionHandler('nexttrack', playNextMusic);
                  navigator.mediaSession.setActionHandler('previoustrack', () => {
                      currentIndex = (currentIndex - 1 + musicItems.length) % musicItems.length;
                      playMusic(currentIndex);
                  });
              }
              loadingContainer.style.display = 'inline-flex';
              audioPlayer.src = musicUrl;
              audioPlayer.play()
                  .catch((error) => {
                      console.error('Autoplay blocked. Please click the play button.', error);
                      if (navigator.userAgent.includes('Safari') && !navigator.userAgent.includes('Chrome')) {
                          safariPopup.style.display = 'flex';
                      }
                  })
                  .finally(() => {
                      loadingContainer.style.display = 'none';
                  });
          }

          function playNextMusic() {
              if (repeatOnce) {
                  audioPlayer.currentTime = 0;
                  audioPlayer.play();
              } else if (repeatAll) {
                  currentIndex = (currentIndex + 1) % musicItems.length;
                  playMusic(currentIndex);
              } else {
                  currentIndex += 1;
                  if (currentIndex < musicItems.length) {
                      playMusic(currentIndex);
                  } else {
                      currentIndex = 0;
                  }
              }
          }
          audioPlayer.addEventListener('ended', playNextMusic);

          function toggleButtonActive(button, isActive) {
              if (isActive) {
                  button.classList.add('active-control');
              } else {
                  button.classList.remove('active-control');
              }
          }

          repeatOnceButton.addEventListener('click', () => {
              repeatOnce = !repeatOnce;
              toggleButtonActive(repeatOnceButton, repeatOnce);
              if (repeatOnce) {
                  repeatAll = false;
                  toggleButtonActive(repeatAllButton, false);
              }
          });
          repeatAllButton.addEventListener('click', () => {
              repeatAll = !repeatAll;
              toggleButtonActive(repeatAllButton, repeatAll);
              if (repeatAll) {
                  repeatOnce = false;
                  toggleButtonActive(repeatOnceButton, false);
              }
          });

          async function init() {
              musicItems = await fetchMusicData();
              if (musicItems && musicItems.length > 0) {
                displayMusicList(musicItems);
              } else {
                musicListElement.innerHTML = '<li>No audio episodes found or failed to load.</li>';
              }
          }
          init();

          function closePopup() {
              safariPopup.style.display = 'none';
          }
      </script>
   </body>
</html>
