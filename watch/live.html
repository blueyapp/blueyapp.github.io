<!DOCTYPE html>
<html lang="en">
<head>
  <title>Bitmovin Player Demo</title>
  <meta charset="UTF-8"/>
  <meta http-equiv="X-UA-Compatible" content="text/html; charset=utf-8" />

  <!-- Bitmovin Player -->
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/bitmovin-player@8/bitmovinplayer.js"></script>
  <style>
    .bmpui-ui-watermark {
       display: none;
    }

    /* Loading Screen Styles */
    .loading-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: #87c0e8;
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 9999; 
    }

    .loading-message {
      color: #ffffff;
      font-size: 24px;
      font-family: sans-serif;
      overflow: hidden; 
    }

    .loading-message span {
      display: inline-block;
      animation: loadingDots 1s infinite alternate;
    }

    @keyframes loadingDots {
      from { opacity: 0; }
      to   { opacity: 1; }
    }
  </style>
</head>
<body>
  <div class="loading-overlay">
    <div class="loading-message">Loading<span>.</span><span>.</span><span>.</span></div>
  </div>
  
<div class="player-wrapper">
  <div id="player"></div>
</div>

  <script>
    // Function to handle page navigation
    function loadPage(url) {
      window.location.href = url;
    }

    // Loading screen logic 
    const loadingOverlay = document.querySelector('.loading-overlay');

    function sendPing() {
      fetch('https://live.bluey.cloudns.org/iptv/channel/1.m3u8')
        .then(() => {
          // Ping successful - hide loading, show video, and reload
          loadingOverlay.style.display = 'none'; 
          document.querySelector('.container').style.display = 'block';
          
          // Reload the Bitmovin Player source
          player.load(source);
        })
        .catch((error) => {
          console.error('Ping error:', error);
          // Ping failed - retry after a short delay
          setTimeout(sendPing, 2000); // Retry every 2 seconds
        });
    }

    sendPing();

    // Bitmovin Player setup
    var conf = {
      key: 'fba29d36-759d-4de3-971d-b0a89d7f84e8',
    };

    var source = {
      title: 'Bluey Fest Live Stream',
      hls: 'https://live.bluey.cloudns.org/iptv/session/1/hls.m3u8',
      poster: 'https://i.ibb.co/zbKZj22/image.png',
    };

    var player = new bitmovin.player.Player(document.getElementById('player'), conf);
    player.load(source);
  </script>

</body>
</html>
